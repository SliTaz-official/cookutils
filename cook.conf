# Cook packages builder configuration file
#

# Use mirror.slitaz.org urls before $WGET_URL. This is useful for computers hosted
# on local lan with a computer that is using source dvd
LAN_MIRROR=""
# Auto install all depends and build depends. (aka. The Tazwok way)
AUTO_DEP=""
# Fully cook all packages in list without install any packages from packages folder
FULL_COOK=""
# Shrink png in lzma source tarballs
SHRINKPNG="0"
# Set lzma dictionary size
# -d24 = 16mb dictionary size
# -d25 = 32mb dictionary size
# -d26 = 64mb dictionary size
LZMA_SET_DIR="-d26"
# touch all files to fix new sources
TOUCH_FILES=""
# remove original tarball when making .tar.lzma
REMOVE_ORIG_TARBALL="0"
# auto update incoming database when using pkg option
AUTO_UPDATE_DB="0"

# auto purge old source tarball
AUTO_PURGE_SRC=""
# Enable recompressing to .tar.lzma
LZMA_SRC="0"
# Enable cooker pkg to cook wanted packages
COOK_WANTED="0"
# enable clean chroot
CLEAN_CHROOT="0"
# Enable using aufs
AUFS_MODE=""
# Rebuild cooklist the tazwok way
UPCOOKLIST="0"
# Update chroot
UPCHROOT="0"

# SliTaz working directory
# NOTE: $SLITAZ_HOME and $SLITAZ_RELEASE is in /etc/slitaz/slitaz.conf
SLITAZ="$SLITAZ_HOME/$SLITAZ_RELEASE"
# Source tarball mirror
ONLINE_SRC_REPOSITORY="$MIRROR_URL/sources/packages/"

# Directory paths for cookutils DB and files.
WOK="$SLITAZ/wok"
PKGS="$SLITAZ/packages"
WOKHG="$SLITAZ/wok-hg"
SRC="$SLITAZ/src"
CACHE="$SLITAZ/cache"
LOGS="$SLITAZ/log"
FEEDS="$SLITAZ/xml"
INCOMING="$SLITAZ/incoming"
DATA="/usr/share/cook"

# System packages DB.
DB="/var/lib/tazpkg"
INSTALLED="$DB/installed"

# Quality Assurance (empty to disable receipt_quality).
QA="0"

# Automatically cook missing build dependencies (empty to disable).
AUTO_COOK=""

# Hg wok for setup and flavors URL for the Cooker.
WOK_URL="http://hg.slitaz.org/wok"
FLAVORS_URL="http://hg.slitaz.org/flavors"

# Cooker URL for RSS feed link (http://localhost/cgi-bin/cooker/cooker.cgi)
COOKER_URL="http://cook.slitaz.org/"

# Translation files to be included in packages.
LOCALE=""

# Target host architecture type (Glibc doesn't support i386 anymore).
ARCH="i486"

# Build and host. These options are for cross-compiling. If you specify
# both options and BUILD_SYSTEM is different from HOST_SYSTEM, configure
# will prepare to cross-compile from BUILD_SYSTEM to be used on HOST_SYSTEM.
#BUILD_SYSTEM="$(uname -m)-slitaz-linux"
BUILD_SYSTEM="$ARCH-slitaz-linux"
HOST_SYSTEM="$ARCH-slitaz-linux"

# SliTaz uses the sysroot method, this tells GCC to consider dir as the root
# of a tree that contains a (subset of) the root filesystem of the target
# operating system. Target system headers, libraries and run-time object
# files will be searched in there. Cook will use the tools and sysroot in
# the CROSS_TREE for cross compiling. Example: CROSS_TREE="/cross/$ARCH"
CROSS_TREE=""

# List of packages installed in chroot by cook or the Cooker setup.
# When cross compiling we need some build system tools installed and
# some cross-compiled bdeps installed in: $PREFIX (cross host root)
CROSS_SETUP="slitaz-toolchain zlib-dev bzip2 aufs-utils aufs bash m4 \
autoconf automake libtool gettext"

# SliTaz optimisation flags - Wide compatibility & optimized for ARCH.
#
# With -O2: binutils: Produce 14.0M Packed 5.5M Compressed 1.2M
# With -Os: binutils: Produce 13.4M Packed 4.9M Compressed 1.1M
#
# ARM:  don't use -0s but -02
# ARM: -mcpu=name [arm9|xscale|...] or -march=name [armv4|armv6|...]
# x86_64: CFLAGS="-march=nocona -Os -pipe"
#
#MAKEFLAGS="-j$(($(grep processor /proc/cpuinfo | wc -l)+1))"
MAKEFLAGS="-j$(grep processor /proc/cpuinfo | wc -l)"
CFLAGS="-march=$ARCH -Os -pipe -fomit-frame-pointer"
CXXFLAGS="$CFLAGS"

# Binutils 2.22 breaks many packages built without LDFLAGS set correctly.
#LDFLAGS="-Wl,--copy-dt-needed-entries -lXt"

# Default tool prefix for Binutils.
TOOLPREFIX="${HOST_SYSTEM}-"

# Default arguments for GNU configure. CONFIGURE_ARGS is needed for some
# packages since --build and --host is not set at all by cook.site (bug ?).
CONFIG_SITE=/etc/slitaz/cook.site
CONFIGURE_ARGS="--build=$BUILD_SYSTEM --host=$HOST_SYSTEM"

# Timeout for connection
TIMEOUT="12"

# Mirrors URLs. To download sources near your location.
GNU_MIRROR="ftp://sunsite.cnlab-switch.ch/mirror/gnu"
SF_MIRROR="http://switch.dl.sourceforge.net/sourceforge"
XORG_MIRROR="ftp://ftp.solnet.ch/mirror/x.org/pub/individual"
GNOME_MIRROR="http://ftp.gnome.org/pub/GNOME/sources"

TOOLCHAIN="slitaz-toolchain
busybox
ncurses
bash
bzip2
gawk
gettext
m4
make
patch
db
gdbm
zlib-dev
perl
texinfo
autoconf
automake
lzma
tar
kmod
xorg-dev"

TOOLCHAIN_EXTRA="tazpkg
cookutils
glib
pkg-config
libtool
libpthread-stubs
mercurial
rsync
wget"

AUFS_PKGS="aufs-utils
aufs"

# List of packages installed by cook or the Cooker setup.
SETUP_PKGS="$TOOLCHAIN
$TOOLCHAIN_EXTRA
intltool
gettext
bzip2"

# List of filesystems into the aufs chroot (to protect / against modifications)
# Default tank config:
AUFS_MOUNTS="/ /proc /sys /dev/shm /dev/pts /var/cache/tazpkg \
/home /home/slitaz/src /home/slitaz/packages"

if [ "$AUFS_MODE" ]; then
	INSTALL_PKGS="$SETUP_PKGS $AUFS_PKGS"
else
	INSTALL_PKGS="$SETUP_PKGS"
fi

# Old way/tazwok compatibility.
BUILD_HOST="$HOST_SYSTEM"
SOURCES_REPOSITORY=$SRC
